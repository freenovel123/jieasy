import{f as Q,l as h,g as d,a as l,r,d as m,o as y,c as Y,b as p,w as n,s as J,t as Z,M as V,N as ee,V as te,W as le,h as N,X as ae,v as se,x as oe,D as O,p as ne,e as ue,_ as ie}from"./index-CnqRjey8.js";import{d as re,e as ce,f as ve,g as de}from"./api-CgQNVbzS.js";import pe from"./DebugJsLog-DFvYr2TC.js";import ge from"./DebugTools-B0Q36-7x.js";import fe from"./DebugVisibleUi-BMpeYWzI.js";import"./index-C3LNL25c.js";const me=f=>(ne("data-v-718b068e"),f=f(),ue(),f),_e={class:"debug"},be={class:"debug-view"},he={class:"debug-view-tabs"},ye={class:"debug-view-option"},De={class:"debug-view-option__left"},Se={class:"debug-view-option__left__text"},Le={class:"debug-view-option__right"},ke=me(()=>p("span",null,"JS Log",-1)),Ce={class:"run"};function je(f){return typeof f=="function"||Object.prototype.toString.call(f)==="[object Object]"&&!ae(f)}const we=Q({__name:"Debug",props:{height:{type:Number,default:0},siteJson:{type:String,default:"{}"}},setup(f){const _=f,B=getComputedStyle(document.documentElement).getPropertyValue("--td-comp-size-xxl"),D=h(()=>({height:`${_.height-parseFloat(B)*2}px`})),u=d(0),S=d(!1),L=d(!1),k=d(!1),$=e=>{let t="前置请求";return e===1?t="正式请求":e===2&&(t="分页请求"),t},C=d([{title:"序号",width:60,cell:(e,{rowIndex:t})=>String(t+1)},{title:"类型",width:90,cell:(e,{row:t})=>{let s;return l(r("t-tag"),null,je(s=$(t.responseType))?s:{default:()=>[s]})}},{title:"访问地址",cell:(e,{row:t})=>{let s=l(r("t-tag"),null,{default:()=>[m("未获得请求地址")]});return t.newUrl&&(s=l("div",null,[l(r("t-space"),{size:"5px"},{default:()=>[l(r("t-tag"),{theme:"primary"},{default:()=>[t.method]}),l(r("t-tooltip"),{content:t.newUrl},{default:()=>[l(r("t-tag"),{maxWidth:"300px"},{default:()=>[t.newUrl]})]})]})])),s}},{title:"状态",width:100,cell:(e,{row:t})=>l("div",null,[t.httpStatus===200?l(r("t-tag"),{theme:"success"},{default:()=>[m("OK 200")]}):l(r("t-tag"),null,{default:()=>[t.httpStatus?t.httpStatus:"请求失败"]})])},{colKey:"operation",title:"操作",width:"100",foot:"-"}]),i=d({list:[],resultData:[],jsLog:"",gets:{}}),o=d({list:[],resultData:{bookInfo:{},chapterList:[]},jsLog:"",gets:{}}),v=d({list:[],resultData:{},jsLog:"",gets:{}}),E=()=>{i.value.list=[],i.value.resultData=[],i.value.jsLog="",i.value.gets={}},R=()=>{o.value.list=[],o.value.resultData.chapterList=[],o.value.resultData.bookInfo={},o.value.jsLog="",o.value.gets={}},U=()=>{v.value.list=[],v.value.resultData={},v.value.jsLog="",v.value.gets={}},g=d(!1),b=d(),F=()=>{g.value?re(u).then(e=>{e&&(g.value=!1,b.value.abort())}):(g.value=!0,u.value===0?K():u.value===1?W():u.value===2&&X())},K=()=>{E(),R();const e=se(oe.sourceDebugSearch,"修仙"),{searchRequest:t,searchAbort:s}=ce(e.value,O(_.siteJson));b.value=s,t.then(a=>{i.value.list=a.list,i.value.jsLog=a.jsLog,i.value.gets=a.gets,a.resultData&&(i.value.resultData=JSON.parse(a.resultData))}).finally(()=>{g.value=!1})},W=()=>{R(),U();const e=i.value.resultData[0],{chapterRequest:t,chapterAbort:s}=ve(JSON.stringify(e),O(_.siteJson));b.value=s,t.then(a=>{o.value.list=a.list,o.value.jsLog=a.jsLog,o.value.gets=a.gets,a.resultData&&(o.value.resultData=JSON.parse(a.resultData))}).finally(()=>{g.value=!1})},X=()=>{U();const e=o.value.resultData.chapterList[0],{contentRequest:t,contentAbort:s}=de(JSON.stringify(e),O(_.siteJson));b.value=s,t.then(a=>{v.value.list=a.list,v.value.jsLog=a.jsLog,v.value.gets=a.gets,a.resultData&&(v.value.resultData=JSON.parse(a.resultData))}).finally(()=>{g.value=!1})},q=d({}),j=e=>{q.value=e,L.value=!0},H=()=>{k.value=!0},M=h(()=>{let e=0;return u.value===1?e=o.value.list.length:u.value===2?e=v.value.list.length:e=i.value.list.length,e}),A=h(()=>{let e="";return u.value===1?e=o.value.jsLog:u.value===2?e=v.value.jsLog:e=i.value.jsLog,e}),P=()=>{S.value=!0},I=h(()=>{let e;return u.value===1?e=o.value.resultData.chapterList:u.value===2?e=v.value.resultData:e=i.value.resultData,e});return(e,t)=>{const s=r("t-link"),a=r("t-table"),w=r("t-tab-panel"),G=r("t-tabs"),x=r("t-button"),z=r("t-tooltip");return y(),Y("div",_e,[p("div",be,[p("div",he,[l(G,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=c=>u.value=c),theme:"card"},{default:n(()=>[l(w,{value:0,label:"搜索测试","destroy-on-hide":!1},{default:n(()=>[p("div",{class:"scrollable-container",style:J(D.value)},[l(a,{"row-key":"index",data:i.value.list,columns:C.value,"cell-empty-content":"-","async-loading":g.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(s,{theme:"primary",onClick:T=>j(c)},{default:n(()=>[m("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1}),l(w,{value:1,label:"章节测试","destroy-on-hide":!1,disabled:i.value.resultData.length===0},{default:n(()=>[p("div",{class:"scrollable-container",style:J(D.value)},[l(a,{"row-key":"index",data:o.value.list,columns:C.value,"cell-empty-content":"-","async-loading":g.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(s,{theme:"primary",onClick:T=>j(c)},{default:n(()=>[m("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1},8,["disabled"]),l(w,{value:2,label:"正文测试","destroy-on-hide":!1,disabled:o.value.resultData.chapterList.length===0},{default:n(()=>[p("div",{class:"scrollable-container",style:J(D.value)},[l(a,{"row-key":"index",data:v.value.list,columns:C.value,"cell-empty-content":"-","async-loading":g.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(s,{theme:"primary",onClick:T=>j(c)},{default:n(()=>[m("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),p("div",ye,[p("div",De,[p("span",Se,"共 "+Z(M.value)+" 次请求",1)]),p("div",Le,[A.value?(y(),V(x,{key:0,onClick:H},{default:n(()=>[ke]),_:1})):ee("",!0)])]),p("div",Ce,[l(z,{content:"View"},{default:n(()=>[l(x,{shape:"square",disabled:te(le)(I.value),onClick:P},{default:n(()=>[l(N,{name:"view"})]),_:1},8,["disabled"])]),_:1}),l(z,{content:"Run"},{default:n(()=>[l(x,{onClick:F},{default:n(()=>[g.value?(y(),V(N,{key:0,theme:"primary",name:"run-stop"})):(y(),V(N,{key:1,theme:"primary",name:"run"}))]),_:1})]),_:1})])])]),l(fe,{visible:S.value,"onUpdate:visible":t[1]||(t[1]=c=>S.value=c),type:u.value,data:I.value},null,8,["visible","type","data"]),l(ge,{visible:L.value,"onUpdate:visible":t[2]||(t[2]=c=>L.value=c),data:q.value},null,8,["visible","data"]),l(pe,{visible:k.value,"onUpdate:visible":t[3]||(t[3]=c=>k.value=c),type:u.value,data:A.value},null,8,["visible","type","data"])])}}}),qe=ie(we,[["__scopeId","data-v-718b068e"]]);export{qe as default};
