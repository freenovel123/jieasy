import{f as le,l as C,g as f,a as l,r as v,d as b,o as y,c as ae,b as g,w as n,s as j,M as x,N as E,t as se,V as oe,W as ue,h as R,X as ne,v as ie,x as re,D as J,p as ce,e as ve,_ as de}from"./index-DQ6KTaqe.js";import{d as pe,e as fe,f as ge,g as me,h as be}from"./api-C5NLXlIS.js";import he from"./DebugJsLog-V67HA3Ys.js";import _e from"./DebugTools-DLSSsXDx.js";import ye from"./DebugVisibleUi-OZrc7oMS.js";import"./index-UwqACce9.js";const De=m=>(ce("data-v-fc2c4c5e"),m=m(),ve(),m),Se={class:"debug"},ke={class:"debug-view"},Le={class:"debug-view-tabs"},Ce={class:"debug-view-option"},je={class:"debug-view-option__left"},xe={class:"debug-view-option__left__text"},Je={class:"debug-view-option__right"},we=De(()=>g("span",null,"JS Log",-1)),Ie={class:"run"};function Ne(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!ne(m)}const Oe=le({__name:"Debug",props:{height:{type:Number,default:0},siteJson:{type:String,default:"{}"}},setup(m){const h=m,F=getComputedStyle(document.documentElement).getPropertyValue("--td-comp-size-xxl"),D=C(()=>({height:`${h.height-parseFloat(F)*2}px`})),u=f(0),w=f(!1),I=f(!1),N=f(!1),K=e=>{let t="前置请求";return e===1?t="正式请求":e===2?t="分页请求":e===3?t="浏览器过盾":e===4&&(t="图片验证码"),t},W=e=>e.responseType>2?l(v("t-tag"),{theme:"success"},{default:()=>[b("组件请求")]}):l("div",null,[e.httpStatus===200?l(v("t-tag"),{theme:"success"},{default:()=>[b("OK 200")]}):l(v("t-tag"),null,{default:()=>[e.httpStatus?e.httpStatus:"请求失败"]})]),S=f([{title:"序号",width:60,cell:(e,{rowIndex:t})=>String(t+1)},{title:"类型",width:90,cell:(e,{row:t})=>{let o;return l(v("t-tag"),null,Ne(o=K(t.responseType))?o:{default:()=>[o]})}},{title:"访问地址",cell:(e,{row:t})=>{let o=l(v("t-tag"),null,{default:()=>[b("未获得请求地址")]});return t.newUrl&&(o=l("div",null,[l(v("t-space"),{size:"5px"},{default:()=>[t.httpStatus!==0&&t.responseType<=2?l(v("t-tag"),{theme:"primary"},{default:()=>[t.method]}):"",l(v("t-tooltip"),{content:t.newUrl},{default:()=>[l(v("t-tag"),{maxWidth:"300px"},{default:()=>[t.newUrl]})]})]})])),o}},{title:"状态",width:100,cell:(e,{row:t})=>W(t)},{colKey:"operation",title:"操作",width:"100",foot:"-"}]),s=f({list:[],resultData:[],jsLog:"",gets:{}}),i=f({list:[],resultData:{},jsLog:"",gets:{}}),r=f({list:[],resultData:{bookInfo:{},chapterList:[]},jsLog:"",gets:{}}),d=f({list:[],resultData:{},jsLog:"",gets:{}}),X=()=>{s.value.list=[],s.value.resultData=[],s.value.jsLog="",s.value.gets={}},U=()=>{i.value.list=[],i.value.resultData={},i.value.jsLog="",i.value.gets={}},q=()=>{r.value.list=[],r.value.resultData.chapterList=[],r.value.resultData.bookInfo={},r.value.jsLog="",r.value.gets={}},A=()=>{d.value.list=[],d.value.resultData={},d.value.jsLog="",d.value.gets={}},p=f(!1),_=f(),H=()=>{p.value?pe(u).then(e=>{e&&(p.value=!1,_.value.abort())}):(p.value=!0,u.value===0?M():u.value===1?P():u.value===2?G():u.value===3&&Q())},M=()=>{X(),U();const e=ie(re.sourceDebugSearch,"修仙"),{searchRequest:t,searchAbort:o}=fe(e.value,J(h.siteJson));_.value=o,t.then(a=>{s.value.list=a.list,s.value.jsLog=a.jsLog,s.value.gets=a.gets,a.resultData&&(s.value.resultData=JSON.parse(a.resultData))}).finally(()=>{p.value=!1})},P=()=>{U(),q();const e=s.value.resultData[0],{bookInfoRequest:t,bookInfoAbort:o}=ge(JSON.stringify(e),J(h.siteJson));_.value=o,t.then(a=>{i.value.list=a.list,i.value.jsLog=a.jsLog,i.value.gets=a.gets,a.resultData&&(i.value.resultData=JSON.parse(a.resultData),s.value.resultData[0]=i.value.resultData)}).finally(()=>{p.value=!1})},G=()=>{q(),A();const e=s.value.resultData[0];i.value.resultData&&i.value.resultData.url&&(e.url=i.value.resultData.url);const{chapterRequest:t,chapterAbort:o}=me(JSON.stringify(e),J(h.siteJson));_.value=o,t.then(a=>{r.value.list=a.list,r.value.jsLog=a.jsLog,r.value.gets=a.gets,a.resultData&&(r.value.resultData=JSON.parse(a.resultData))}).finally(()=>{p.value=!1})},Q=()=>{A();const e=r.value.resultData.chapterList[0],{contentRequest:t,contentAbort:o}=be(JSON.stringify(e),J(h.siteJson));_.value=o,t.then(a=>{d.value.list=a.list,d.value.jsLog=a.jsLog,d.value.gets=a.gets,a.resultData&&(d.value.resultData=JSON.parse(a.resultData))}).finally(()=>{p.value=!1})},B=f({}),k=e=>{B.value=e,I.value=!0},Y=()=>{N.value=!0},Z=C(()=>{let e=0;return u.value===1?e=i.value.list.length:u.value===2?e=r.value.list.length:u.value===3?e=d.value.list.length:e=s.value.list.length,e}),T=C(()=>{let e="";return u.value===1?e=i.value.jsLog:u.value===2?e=r.value.jsLog:u.value===3?e=d.value.jsLog:e=s.value.jsLog,e}),ee=()=>{w.value=!0},z=C(()=>{let e;return u.value===1?e=i.value.resultData:u.value===2?e=r.value.resultData.chapterList:u.value===3?e=d.value.resultData:e=s.value.resultData,e});return(e,t)=>{const o=v("t-link"),a=v("t-table"),L=v("t-tab-panel"),te=v("t-tabs"),O=v("t-button"),$=v("t-tooltip");return y(),ae("div",Se,[g("div",ke,[g("div",Le,[l(te,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=c=>u.value=c),theme:"card"},{default:n(()=>[l(L,{value:0,label:"搜索测试","destroy-on-hide":!1},{default:n(()=>[g("div",{class:"scrollable-container",style:j(D.value)},[l(a,{"row-key":"index",data:s.value.list,columns:S.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:V=>k(c)},{default:n(()=>[b("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1}),s.value.resultData[0]&&s.value.resultData[0].bookUrl?(y(),x(L,{key:0,value:1,label:"详情测试","destroy-on-hide":!1},{default:n(()=>[g("div",{class:"scrollable-container",style:j(D.value)},[l(a,{"row-key":"index",data:i.value.list,columns:S.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:V=>k(c)},{default:n(()=>[b("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1})):E("",!0),l(L,{value:2,label:"章节测试","destroy-on-hide":!1,disabled:s.value.resultData.length===0||s.value.resultData&&!s.value.resultData[0].url},{default:n(()=>[g("div",{class:"scrollable-container",style:j(D.value)},[l(a,{"row-key":"index",data:r.value.list,columns:S.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:V=>k(c)},{default:n(()=>[b("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1},8,["disabled"]),l(L,{value:3,label:"正文测试","destroy-on-hide":!1,disabled:r.value.resultData.chapterList.length===0},{default:n(()=>[g("div",{class:"scrollable-container",style:j(D.value)},[l(a,{"row-key":"index",data:d.value.list,columns:S.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:V=>k(c)},{default:n(()=>[b("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),g("div",Ce,[g("div",je,[g("span",xe,"共 "+se(Z.value)+" 次请求",1)]),g("div",Je,[T.value?(y(),x(O,{key:0,onClick:Y},{default:n(()=>[we]),_:1})):E("",!0)])]),g("div",Ie,[l($,{content:"View"},{default:n(()=>[l(O,{shape:"square",disabled:oe(ue)(z.value),onClick:ee},{default:n(()=>[l(R,{name:"view"})]),_:1},8,["disabled"])]),_:1}),l($,{content:"Run"},{default:n(()=>[l(O,{onClick:H},{default:n(()=>[p.value?(y(),x(R,{key:0,theme:"primary",name:"run-stop"})):(y(),x(R,{key:1,theme:"primary",name:"run"}))]),_:1})]),_:1})])])]),l(ye,{visible:w.value,"onUpdate:visible":t[1]||(t[1]=c=>w.value=c),type:u.value,data:z.value},null,8,["visible","type","data"]),l(_e,{visible:I.value,"onUpdate:visible":t[2]||(t[2]=c=>I.value=c),data:B.value},null,8,["visible","data"]),l(he,{visible:N.value,"onUpdate:visible":t[3]||(t[3]=c=>N.value=c),type:u.value,data:T.value},null,8,["visible","type","data"])])}}}),ze=de(Oe,[["__scopeId","data-v-fc2c4c5e"]]);export{ze as default};
