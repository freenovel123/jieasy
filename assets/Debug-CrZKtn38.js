import{f as te,l as j,g,a as l,r as v,d as m,o as y,c as le,b as f,w as n,s as C,M as w,N as E,t as ae,V as se,W as oe,h as R,X as ue,v as ne,x as ie,D as x,p as re,e as ce,_ as ve}from"./index-opJMMxrH.js";import{d as de,e as pe,f as ge,g as fe,h as be}from"./api-x5B807Pu.js";import me from"./DebugJsLog-BLLx87R5.js";import he from"./DebugTools-BggYNjo5.js";import _e from"./DebugVisibleUi-BnPrLXLF.js";import"./index-CQX5SaM7.js";const ye=b=>(re("data-v-bc625daa"),b=b(),ce(),b),De={class:"debug"},ke={class:"debug-view"},Se={class:"debug-view-tabs"},Le={class:"debug-view-option"},je={class:"debug-view-option__left"},Ce={class:"debug-view-option__left__text"},we={class:"debug-view-option__right"},xe=ye(()=>f("span",null,"JS Log",-1)),Je={class:"run"};function Ne(b){return typeof b=="function"||Object.prototype.toString.call(b)==="[object Object]"&&!ue(b)}const Oe=te({__name:"Debug",props:{height:{type:Number,default:0},siteJson:{type:String,default:"{}"}},setup(b){const h=b,F=getComputedStyle(document.documentElement).getPropertyValue("--td-comp-size-xxl"),D=j(()=>({height:`${h.height-parseFloat(F)*2}px`})),u=g(0),J=g(!1),N=g(!1),O=g(!1),K=e=>{let t="前置请求";return e===1?t="正式请求":e===2&&(t="分页请求"),t},k=g([{title:"序号",width:60,cell:(e,{rowIndex:t})=>String(t+1)},{title:"类型",width:90,cell:(e,{row:t})=>{let o;return l(v("t-tag"),null,Ne(o=K(t.responseType))?o:{default:()=>[o]})}},{title:"访问地址",cell:(e,{row:t})=>{let o=l(v("t-tag"),null,{default:()=>[m("未获得请求地址")]});return t.newUrl&&(o=l("div",null,[l(v("t-space"),{size:"5px"},{default:()=>[l(v("t-tag"),{theme:"primary"},{default:()=>[t.method]}),l(v("t-tooltip"),{content:t.newUrl},{default:()=>[l(v("t-tag"),{maxWidth:"300px"},{default:()=>[t.newUrl]})]})]})])),o}},{title:"状态",width:100,cell:(e,{row:t})=>l("div",null,[t.httpStatus===200?l(v("t-tag"),{theme:"success"},{default:()=>[m("OK 200")]}):l(v("t-tag"),null,{default:()=>[t.httpStatus?t.httpStatus:"请求失败"]})])},{colKey:"operation",title:"操作",width:"100",foot:"-"}]),s=g({list:[],resultData:[],jsLog:"",gets:{}}),i=g({list:[],resultData:{},jsLog:"",gets:{}}),r=g({list:[],resultData:{bookInfo:{},chapterList:[]},jsLog:"",gets:{}}),d=g({list:[],resultData:{},jsLog:"",gets:{}}),W=()=>{s.value.list=[],s.value.resultData=[],s.value.jsLog="",s.value.gets={}},U=()=>{i.value.list=[],i.value.resultData={},i.value.jsLog="",i.value.gets={}},q=()=>{r.value.list=[],r.value.resultData.chapterList=[],r.value.resultData.bookInfo={},r.value.jsLog="",r.value.gets={}},A=()=>{d.value.list=[],d.value.resultData={},d.value.jsLog="",d.value.gets={}},p=g(!1),_=g(),X=()=>{p.value?de(u).then(e=>{e&&(p.value=!1,_.value.abort())}):(p.value=!0,u.value===0?H():u.value===1?M():u.value===2?P():u.value===3&&G())},H=()=>{W(),U();const e=ne(ie.sourceDebugSearch,"修仙"),{searchRequest:t,searchAbort:o}=pe(e.value,x(h.siteJson));_.value=o,t.then(a=>{s.value.list=a.list,s.value.jsLog=a.jsLog,s.value.gets=a.gets,a.resultData&&(s.value.resultData=JSON.parse(a.resultData))}).finally(()=>{p.value=!1})},M=()=>{U(),q();const e=s.value.resultData[0],{bookInfoRequest:t,bookInfoAbort:o}=ge(JSON.stringify(e),x(h.siteJson));_.value=o,t.then(a=>{i.value.list=a.list,i.value.jsLog=a.jsLog,i.value.gets=a.gets,a.resultData&&(i.value.resultData=JSON.parse(a.resultData),s.value.resultData[0]=i.value.resultData)}).finally(()=>{p.value=!1})},P=()=>{q(),A();const e=s.value.resultData[0];i.value.resultData&&i.value.resultData.url&&(e.url=i.value.resultData.url);const{chapterRequest:t,chapterAbort:o}=fe(JSON.stringify(e),x(h.siteJson));_.value=o,t.then(a=>{r.value.list=a.list,r.value.jsLog=a.jsLog,r.value.gets=a.gets,a.resultData&&(r.value.resultData=JSON.parse(a.resultData))}).finally(()=>{p.value=!1})},G=()=>{A();const e=r.value.resultData.chapterList[0],{contentRequest:t,contentAbort:o}=be(JSON.stringify(e),x(h.siteJson));_.value=o,t.then(a=>{d.value.list=a.list,d.value.jsLog=a.jsLog,d.value.gets=a.gets,a.resultData&&(d.value.resultData=JSON.parse(a.resultData))}).finally(()=>{p.value=!1})},z=g({}),S=e=>{z.value=e,N.value=!0},Q=()=>{O.value=!0},Y=j(()=>{let e=0;return u.value===1?e=i.value.list.length:u.value===2?e=r.value.list.length:u.value===3?e=d.value.list.length:e=s.value.list.length,e}),B=j(()=>{let e="";return u.value===1?e=i.value.jsLog:u.value===2?e=r.value.jsLog:u.value===3?e=d.value.jsLog:e=s.value.jsLog,e}),Z=()=>{J.value=!0},T=j(()=>{let e;return u.value===1?e=i.value.resultData:u.value===2?e=r.value.resultData.chapterList:u.value===3?e=d.value.resultData:e=s.value.resultData,e});return(e,t)=>{const o=v("t-link"),a=v("t-table"),L=v("t-tab-panel"),ee=v("t-tabs"),V=v("t-button"),$=v("t-tooltip");return y(),le("div",De,[f("div",ke,[f("div",Se,[l(ee,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=c=>u.value=c),theme:"card"},{default:n(()=>[l(L,{value:0,label:"搜索测试","destroy-on-hide":!1},{default:n(()=>[f("div",{class:"scrollable-container",style:C(D.value)},[l(a,{"row-key":"index",data:s.value.list,columns:k.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:I=>S(c)},{default:n(()=>[m("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1}),s.value.resultData[0]&&s.value.resultData[0].bookUrl?(y(),w(L,{key:0,value:1,label:"详情测试","destroy-on-hide":!1},{default:n(()=>[f("div",{class:"scrollable-container",style:C(D.value)},[l(a,{"row-key":"index",data:i.value.list,columns:k.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:I=>S(c)},{default:n(()=>[m("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1})):E("",!0),l(L,{value:2,label:"章节测试","destroy-on-hide":!1,disabled:s.value.resultData.length===0||s.value.resultData&&!s.value.resultData[0].url},{default:n(()=>[f("div",{class:"scrollable-container",style:C(D.value)},[l(a,{"row-key":"index",data:r.value.list,columns:k.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:I=>S(c)},{default:n(()=>[m("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1},8,["disabled"]),l(L,{value:3,label:"正文测试","destroy-on-hide":!1,disabled:r.value.resultData.chapterList.length===0},{default:n(()=>[f("div",{class:"scrollable-container",style:C(D.value)},[l(a,{"row-key":"index",data:d.value.list,columns:k.value,"cell-empty-content":"-","async-loading":p.value?"loading":"","lazy-load":"",stripe:""},{operation:n(({row:c})=>[l(o,{theme:"primary",onClick:I=>S(c)},{default:n(()=>[m("检查")]),_:2},1032,["onClick"])]),_:1},8,["data","columns","async-loading"])],4)]),_:1},8,["disabled"])]),_:1},8,["modelValue"]),f("div",Le,[f("div",je,[f("span",Ce,"共 "+ae(Y.value)+" 次请求",1)]),f("div",we,[B.value?(y(),w(V,{key:0,onClick:Q},{default:n(()=>[xe]),_:1})):E("",!0)])]),f("div",Je,[l($,{content:"View"},{default:n(()=>[l(V,{shape:"square",disabled:se(oe)(T.value),onClick:Z},{default:n(()=>[l(R,{name:"view"})]),_:1},8,["disabled"])]),_:1}),l($,{content:"Run"},{default:n(()=>[l(V,{onClick:X},{default:n(()=>[p.value?(y(),w(R,{key:0,theme:"primary",name:"run-stop"})):(y(),w(R,{key:1,theme:"primary",name:"run"}))]),_:1})]),_:1})])])]),l(_e,{visible:J.value,"onUpdate:visible":t[1]||(t[1]=c=>J.value=c),type:u.value,data:T.value},null,8,["visible","type","data"]),l(he,{visible:N.value,"onUpdate:visible":t[2]||(t[2]=c=>N.value=c),data:z.value},null,8,["visible","data"]),l(me,{visible:O.value,"onUpdate:visible":t[3]||(t[3]=c=>O.value=c),type:u.value,data:B.value},null,8,["visible","type","data"])])}}}),Be=ve(Oe,[["__scopeId","data-v-bc625daa"]]);export{Be as default};
